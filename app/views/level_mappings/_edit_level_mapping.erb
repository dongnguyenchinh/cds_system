<%= stylesheet_link_tag "form", media: "all", 'data-turbolinks-track': "reload" %>
<%= javascript_include_tag 'edit_level_mapping', 'data-turbolinks-track': 'reload' %>
<div id="alert-success" class="alert alert-success" data-alert="alert"><div id="content-alert-success"></div></div>
<div id="alert-danger" class="alert alert-danger" data-alert="alert"><div id="content-alert-fail"></div></div>
<div class='row'>
  <div class='col-12'>
  <div class='basic-table-wrapper'>
      <table class="table table-responsive-sm table-basic table-mytable border-table" id="table_edit_level_mapping">
      <thead>
          <tr>
            <th class="th">Title</th>
            <th class="th">Rank</th>
            <th class="th" >Level</th>
            <th class="tr-staff">Required Competencies (*)</th>
            <th class="th">Action</th>
          </tr>
        </thead>
        <tbody>
        <% @list_level_mapping[:data].each do |item| %>
          <tr data-title-id='<%= item.title_id %>'>
            <td><%= item.title.name %></td>
            <td><%= item.title.rank %></td>
            <td><%= item.level %></td>
            <td>
            <div class="row" data-level-mapping-id="<%= item.id %>" data-is_change='false'>
              <div class='col-3'>
                <input type="number" class="form-control input-quantity" min="1" max="<%= @list_level_mapping[:count_competency] %>" placeholder='Quantity' value="<%= item.quantity%>">
              </div>
              <div class='col-5'>
                <select class="form-control" id="select_type">
                  <option value='<%= item.competency_type %>'selected>
                    <%= item.competency_type %>
                  </option>
                </select>
              </div>
              <div class='col-2'>
                <select class="form-control" id="select_rank">
                  <option value='<%= item.rank_number %>'selected><%= item.rank_number %></option>
                </select>
              </div>
              <div class='col-2 divIcon' style="padding-top:7px">
                <a type='button' class='btnAction' title='Add a Required Competency' id="btn_add_required">
                  <i class='fas fa-plus-circle btnAdd'></i>
                </a>
                <a type='button' class='btnAction invisible' title='Remove a required competency' id="btn_remove_required">
                  <i class='fas fa-times btnDel'></i>
                </a>
              </div>
            </div>
            </td>
            <td>
              <a type='button' class='btnAction invisible' title='Add a level' id="btn_add_level">
                <i class='fa fa-plus btnAdd'></i>
              </a>
              <a type='button' class='btnAction' title='Remove level' id="btn_remove_level">
                <i class='fas fa-times btnDel'></i>
              </a>
            </td>
          </tr>
        <% end %>
        </tbody>
    </table>
  </div>
  </div>
</div>
<div class='row'>
  <div class='col-12 divButton'>
    <button class='btn btn-primary btn-save' id="btn_save">Save</button>
    <a type='button' class='btn btn-light border-dark' href="/level_mappings/">Cancel</a>
  </div>
</div>
<script>
  var max_quantity = <%= @list_level_mapping[:count_competency] %>
  var count = <%= @list_level_mapping[:rank] %>
  var length =  <%= @list_level_mapping[:data].count %>
</script>
